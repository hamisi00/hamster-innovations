/* ============================================
   DESKTOP-ENHANCED CSS
   Complex animations and effects for desktop only (≥1024px)
   Loaded conditionally to avoid performance impact on mobile
   Requires: base.css, layout.css
   ============================================ */

/* This file should ONLY be loaded on desktop via:
   <link rel="stylesheet" href="css/desktop-enhanced.css" media="(min-width: 1024px)">
*/

/* ==================== NAVIGATION ENHANCEMENTS ==================== */

/* Desktop expanding navigation with 3D animations */
@media (min-width: 1024px) {

    .main-nav {
        width: 80px;
        transition: width 3s cubic-bezier(0.4, 0, 0.2, 1), padding 3s ease;
        overflow: hidden;
    }

    .main-nav.expanded {
        width: calc(100vw - 40px);
    }

    /* Logo fade in/out */
    .main-nav:not(.expanded) .nav-logo {
        opacity: 0;
        width: 0;
        overflow: hidden;
        pointer-events: none;
        transition: opacity 2.5s ease, width 3s ease;
        transition-delay: 1.5s, 1.5s;
    }

    .main-nav.expanded .nav-logo {
        opacity: 1;
        width: auto;
        pointer-events: auto;
        transition-delay: 0.3s, 0s;
    }

    /* Company name fade */
    .main-nav .company-name {
        opacity: 0;
        transition: opacity 3s ease;
        transition-delay: 0.3s;
    }

    .main-nav.expanded .company-name {
        opacity: 1;
    }

    .main-nav:not(.expanded) .company-name {
        opacity: 0;
        transition-delay: 1.5s;
    }

    /* 3D flip-in animation for menu items */
    .main-nav .nav-menu {
        width: 0;
        opacity: 0;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        transition: width 3s ease, opacity 3s ease;
    }

    .main-nav.expanded .nav-menu {
        width: auto;
        opacity: 1;
    }

    .main-nav .nav-menu li {
        transform: rotateY(90deg);
        opacity: 0;
        transition: transform 3s cubic-bezier(0.4, 0, 0.2, 1),
                    opacity 3s ease;
        transform-origin: center;
        perspective: 1000px;
    }

    .main-nav.expanded .nav-menu li {
        transform: rotateY(0deg);
        opacity: 1;
    }

    /* Staggered flip-in when expanding */
    .main-nav.expanded .nav-menu li:nth-child(1) { transition-delay: 0.3s; }
    .main-nav.expanded .nav-menu li:nth-child(2) { transition-delay: 0.6s; }
    .main-nav.expanded .nav-menu li:nth-child(3) { transition-delay: 0.9s; }
    .main-nav.expanded .nav-menu li:nth-child(4) { transition-delay: 1.2s; }
    .main-nav.expanded .nav-menu li:nth-child(5) { transition-delay: 1.5s; }
    .main-nav.expanded .nav-menu li:nth-child(6) { transition-delay: 1.8s; }

    /* Reversed stagger when collapsing */
    .main-nav:not(.expanded) .nav-menu li {
        transition-delay: 0s;
    }

    .main-nav:not(.expanded) .nav-menu li:nth-child(1) { transition-delay: 1.8s; }
    .main-nav:not(.expanded) .nav-menu li:nth-child(2) { transition-delay: 1.5s; }
    .main-nav:not(.expanded) .nav-menu li:nth-child(3) { transition-delay: 1.2s; }
    .main-nav:not(.expanded) .nav-menu li:nth-child(4) { transition-delay: 0.9s; }
    .main-nav:not(.expanded) .nav-menu li:nth-child(5) { transition-delay: 0.6s; }
    .main-nav:not(.expanded) .nav-menu li:nth-child(6) { transition-delay: 0.3s; }

    /* Theatrical spinning hamburger */
    .nav-toggle .line {
        transition: transform 3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .main-nav.expanded .nav-toggle .line1 {
        transform: translateX(-50%) translateY(3.5px) rotate(405deg);
        /* 405deg = 360deg (full spin) + 45deg (X position) */
    }

    .main-nav.expanded .nav-toggle .line2 {
        transform: translateX(-50%) translateY(-3.5px) rotate(-405deg);
        /* -405deg = -360deg (full spin) + -45deg (X position) */
    }

    /* Explicit collapsed state */
    .main-nav:not(.expanded) .nav-toggle .line1 {
        transform: translateX(-50%) translateY(0) rotate(0deg);
    }

    .main-nav:not(.expanded) .nav-toggle .line2 {
        transform: translateX(-50%) translateY(0) rotate(0deg);
    }
}

/* ==================== BACKGROUND ANIMATIONS ==================== */

/* Animated bokeh elements - desktop only */
@media (min-width: 1024px) {

    .bokeh-element {
        will-change: transform, opacity;
        animation: float 20s ease-in-out infinite;
    }

    .bokeh-1 {
        animation-duration: 25s;
        animation-delay: 0s;
    }

    .bokeh-2 {
        animation-duration: 30s;
        animation-delay: -5s;
    }

    .bokeh-3 {
        animation-duration: 28s;
        animation-delay: -10s;
    }

    .bokeh-4 {
        animation-duration: 32s;
        animation-delay: -15s;
    }

    @keyframes float {
        0%, 100% {
            transform: translate(0, 0) scale(1);
            opacity: 0.15;
        }
        25% {
            transform: translate(30px, -30px) scale(1.1);
            opacity: 0.2;
        }
        50% {
            transform: translate(-20px, 20px) scale(0.9);
            opacity: 0.12;
        }
        75% {
            transform: translate(20px, 30px) scale(1.05);
            opacity: 0.18;
        }
    }

    /* Parallax background on scroll (applied via JS) */
    .background-image {
        will-change: transform;
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
}

/* ==================== PARALLAX SCROLL EFFECTS ==================== */

@media (min-width: 1024px) {

    /* Parallax layers (applied via JS) */
    [data-animate="parallax"] {
        will-change: transform;
        transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .parallax-foreground {
        will-change: transform;
    }

    .parallax-mid {
        will-change: transform;
    }

    .parallax-background {
        will-change: transform;
    }
}

/* ==================== FEATURE TABS - VIRTUAL SCROLL ==================== */

@media (min-width: 1024px) {

    /* Virtual scroll progression */
    .features-tabs-section {
        min-height: 300vh; /* 3× viewport for scroll progression */
        padding: var(--spacing-3xl) 0 0 0;
    }

    .features-sticky-wrapper {
        position: sticky;
        top: 100px;
        height: 100vh;
        display: flex;
        flex-direction: column;
    }

    /* Position lock when needed (applied via JS) */
    .features-sticky-wrapper.position-locked {
        position: fixed;
        top: 100px;
        left: 0;
        right: 0;
        width: 100%;
        z-index: 100;
    }

    /* Smooth tab transitions */
    .tab-panel {
        transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1),
                    transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        transform: translateX(-20px);
    }

    .tab-panel.active {
        transform: translateX(0);
    }

    /* Tab active pulse animation */
    .feature-tab.active::before {
        animation: tabActivePulse 0.6s ease;
    }

    @keyframes tabActivePulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
}

/* ==================== PACKAGE CARDS - POP-OUT ANIMATION ==================== */

@media (min-width: 1024px) {

    .packages-stack {
        position: relative;
        min-height: 450px;
    }

    .package-card {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        will-change: transform, opacity;
    }

    /* Initial compressed state */
    .package-card[data-index="0"] {
        transform: translate(-50%, -50%) translateX(0) scale(0.95);
        z-index: 4;
        opacity: 1;
    }

    .package-card[data-index="1"] {
        transform: translate(-50%, -50%) translateX(15px) scale(0.95);
        z-index: 3;
        opacity: 0.7;
    }

    .package-card[data-index="2"] {
        transform: translate(-50%, -50%) translateX(30px) scale(0.95);
        z-index: 2;
        opacity: 0.5;
    }

    .package-card[data-index="3"] {
        transform: translate(-50%, -50%) translateX(45px) scale(0.95);
        z-index: 1;
        opacity: 0.3;
    }

    /* Revealed state - horizontal spread (applied via JS) */
    .packages-stack.revealing .package-card[data-index="0"] {
        transform: translate(-50%, -50%) translateX(-480px) scale(1);
        opacity: 1;
        transition: all 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        transition-delay: 0ms;
    }

    .packages-stack.revealing .package-card[data-index="1"] {
        transform: translate(-50%, -50%) translateX(-160px) scale(1);
        opacity: 1;
        transition-delay: 150ms;
    }

    .packages-stack.revealing .package-card[data-index="2"] {
        transform: translate(-50%, -50%) translateX(160px) scale(1);
        opacity: 1;
        transition-delay: 300ms;
    }

    .packages-stack.revealing .package-card[data-index="3"] {
        transform: translate(-50%, -50%) translateX(480px) scale(1);
        opacity: 1;
        transition-delay: 450ms;
    }

    /* Enhanced hover effect when spread */
    .packages-stack.revealing .package-card:hover {
        border-color: rgba(74, 144, 226, 0.4);
        box-shadow: 0 12px 40px rgba(74, 144, 226, 0.2);
        z-index: 10;
    }
}

/* ==================== PRODUCT SHOWCASE - STICKY CASCADE ==================== */

@media (min-width: 1024px) {

    .products-showcase-section {
        min-height: 250vh; /* Allow scroll room for cascade */
    }

    .cascading-cards-container {
        padding-bottom: 60vh;
        display: block; /* Override grid for sticky effect */
    }

    .cascading-card {
        position: sticky;
        margin-bottom: var(--spacing-lg);
        will-change: transform;
    }

    /* Cascading positions with reversed z-index */
    .cascading-card:nth-child(1) {
        top: 100px;
        z-index: 1;
    }

    .cascading-card:nth-child(2) {
        top: 200px;
        z-index: 2;
    }

    .cascading-card:nth-child(3) {
        top: 300px;
        z-index: 3;
    }

    .cascading-card:nth-child(4) {
        top: 400px;
        z-index: 4;
    }

    .cascading-card:nth-child(5) {
        top: 500px;
        z-index: 5;
    }

    .cascading-card:nth-child(6) {
        top: 600px;
        z-index: 6;
    }

    /* Gradient border glow on hover */
    .cascading-card::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: var(--border-radius-lg);
        padding: 2px;
        background: linear-gradient(135deg,
            rgba(74, 144, 226, 0.3),
            rgba(107, 93, 209, 0.2),
            rgba(217, 70, 217, 0.2));
        -webkit-mask: linear-gradient(#fff 0 0) content-box,
                      linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        opacity: 0;
        transition: opacity 0.4s ease;
        pointer-events: none;
    }

    .cascading-card:hover::before {
        opacity: 1;
    }

    /* Enhanced hover lift */
    .cascading-card:hover {
        transform: translateY(-4px) scale(1.01);
        box-shadow: 0 16px 48px rgba(74, 144, 226, 0.25),
                    0 8px 24px rgba(0, 0, 0, 0.5),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    /* Arrow slide animation on hover */
    .cascading-card:hover .card-arrow {
        transform: translateX(8px);
        opacity: 1;
    }

    .card-arrow {
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
    }

    /* Header highlight on hover */
    .cascade-card-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg,
            transparent,
            rgba(74, 144, 226, 0.4),
            transparent);
    }
}

/* ==================== SCROLL ANIMATIONS ==================== */

@media (min-width: 1024px) {

    /* Stagger animations for elements entering viewport */
    [data-animate="fade-up"] {
        transition-delay: 0.1s;
    }

    [data-animate="fade-up"]:nth-child(2) {
        transition-delay: 0.2s;
    }

    [data-animate="fade-up"]:nth-child(3) {
        transition-delay: 0.3s;
    }

    /* Title animation - word by word (applied via JS) */
    .hero-title .word {
        display: inline-block;
        opacity: 0;
        transform: translateY(30px);
        animation: wordSlideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .hero-title .word:nth-child(1) { animation-delay: 0.1s; }
    .hero-title .word:nth-child(2) { animation-delay: 0.3s; }

    @keyframes wordSlideIn {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
}

/* ==================== ENHANCED HOVER EFFECTS ==================== */

@media (min-width: 1024px) and (hover: hover) and (pointer: fine) {

    /* Button hover enhancements */
    .btn-primary:hover {
        box-shadow: 0 0 30px rgba(74, 144, 226, 0.3),
                    0 8px 24px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% {
            box-shadow: 0 0 30px rgba(74, 144, 226, 0.25),
                        0 8px 24px rgba(0, 0, 0, 0.2);
        }
        50% {
            box-shadow: 0 0 40px rgba(74, 144, 226, 0.35),
                        0 12px 32px rgba(0, 0, 0, 0.25);
        }
    }

    /* Nav link underline animation */
    .nav-menu .nav-link::after {
        background: linear-gradient(90deg,
            var(--color-primary),
            var(--color-secondary));
    }

    /* Card hover lift */
    .card:hover,
    .package-card:hover {
        transform: translateY(-6px) scale(1.02);
    }

    /* Image zoom on hover */
    .about-image img,
    .tab-image img,
    .product-screenshot img {
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .about-image:hover img,
    .tab-image:hover img,
    .product-screenshot:hover img {
        transform: scale(1.05);
    }

    .about-image,
    .tab-image,
    .product-screenshot {
        overflow: hidden;
        border-radius: var(--border-radius-md);
    }
}

/* ==================== SMOOTH SCROLL BEHAVIOR ==================== */

@media (min-width: 1024px) {

    html {
        scroll-behavior: smooth;
    }

    /* Enhanced scroll padding for fixed nav */
    html {
        scroll-padding-top: 120px;
    }
}

/* ==================== PERFORMANCE OPTIMIZATIONS ==================== */

@media (min-width: 1024px) {

    /* GPU acceleration for animated elements */
    .nav-menu li,
    .bokeh-element,
    .cascading-card,
    .package-card,
    .background-image,
    [data-animate="parallax"] {
        transform: translateZ(0);
        backface-visibility: hidden;
    }

    /* Reduce motion if user prefers */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }

        .main-nav,
        .nav-menu,
        .nav-menu li,
        .nav-toggle .line {
            transition-duration: 0.3s !important;
        }

        .features-tabs-section {
            min-height: auto !important;
        }

        .bokeh-element {
            animation: none !important;
        }

        [data-animate="parallax"] {
            transform: none !important;
        }
    }
}

/* ==================== CUSTOM CURSOR (OPTIONAL ENHANCEMENT) ==================== */

@media (min-width: 1024px) and (hover: hover) {

    /* Custom cursor for interactive elements */
    .btn,
    .cascading-card,
    .nav-link,
    .feature-tab {
        cursor: pointer;
    }

    /* Magnetic effect on buttons (requires JS) */
    .btn {
        will-change: transform;
    }
}
